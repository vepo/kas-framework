services:
  producer:
    image: openjdk:21-jdk
    command: java -Xms1536m -Xmx1536m -jar /app/data-generator-jar-with-dependencies.jar
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 3gb
        reservations:
          cpus: '2'
          memory: 3gb
    # deploy:
    #   mode: replicated
    #   replicas: 6
    volumes:
      - ./runtime:/app
      - ./dataset:/dataset
    networks:
      - maestro-network
    # extra_hosts:
    #   kafka-0: 201.23.74.39
    #   kafka-1: 201.23.74.39
    #   kafka-2: 201.23.74.39
  test-stream:
    image: openjdk:21-jdk
    command: java -Xms2560m -Xmx2560m -jar /app/sample-stream-jar-with-dependencies.jar
    deploy:
      resources:
        limits:
          cpus: '4'
          memory: 5gb
        reservations:
          cpus: '0.5'
          memory: 5gb
    environment:
      STATS_FOLDER: /app-stats
    volumes:
      - ./runtime:/app
      - ./stats:/app-stats
    networks:
      - maestro-network
    # extra_hosts:
    #   kafka-0: 201.23.74.39
    #   kafka-1: 201.23.74.39
    #   kafka-2: 201.23.74.39
networks:
  maestro-network:
    ## local
    external: true
    ## cloud
    # name: maestro-network
    # driver: bridge